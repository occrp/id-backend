version: "2"

services:
  resolvable:
    image: mgood/resolvable
    volumes:
      - "/var/run/docker.sock:/tmp/docker.sock"
      - "/etc/resolv.conf:/tmp/resolv.conf"

  postgres:
    image: postgres:9.4
    volumes:
      - ".build/data/postgres:/var/lib/postgresql/data"
      - ".build/logs/postgres:/var/log"
    environment:
      POSTGRES_USER:     id2
      POSTGRES_PASSWORD: id2
      POSTGRES_DATABASE: id2

  web:
    build: .
    command: gunicorn -w 5 -b 0.0.0.0:8000 -t 60 --keep-alive 5 --log-level info --log-file - wsgi:application
    expose:
      - "8000"
    links:
      - postgres
    volumes:
      - ".build/dumps/:/dumps/"
    env_file:
      - id.env
