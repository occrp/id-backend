{% extends "admin_base.jinja" %}

{% block admin_content %}

<ul class="nav nav-tabs">
  <li role="presentation"{% if "approved" not in request.path and "denied" not in request.path %} class="active"{% endif %}><a href="{{ url('request_access_list') }}"><i class="fa fa-question"></i> {% trans %}New{% endtrans %}</a></li>
  <li role="presentation"{% if "approved" in request.path %} class="active"{% endif %}><a href="{{ url('request_access_list_approved') }}"><i class="fa fa-check"></i> {% trans %}Approved{% endtrans %}</a></li>
  <li role="presentation"{% if "denied" in request.path %} class="active"{% endif %}><a href="{{ url('request_access_list_denied') }}"><i class="fa fa-times"></i> {% trans %}Denied{% endtrans %}</a></li>
</ul>

  {% for reqtype in ["requester", "volunteer"] %}
    <h3>{{reqtype|capitalize}} waiting for approval</h3>
    <table class="table table-striped table-bordered crud-list">
      <thead>
        <tr>
          <th>{% trans %}First Name{% endtrans %}</th>
          <th>{% trans %}Last Name{% endtrans %}</th>
          <th>{% trans %}Mail address{% endtrans %}</th>
          <th>{% trans %}Creation date{% endtrans %}</th>
          <th>{% trans %}Approve{% endtrans %}</th>
        </tr>
      </thead>
      <tbody>
      {% for req in object_list.filter(request_type=reqtype) %}
        <tr>
          <th>{{req.user.first_name}}</th>
          <th>{{req.user.last_name}}</th>
          <th><a href="{{ url("profile", req.user.id ) }}">{{req.user.email}}</a></th>
          <th>{{ macros.display_datetime(req.date_created) }}</th>
          <th>
            {% if req.approved != True %}
            <a class="btn btn-small" href="{{url('request_access_list')}}?approve_req={{req.id}}">{% trans %}Approve{% endtrans %}</a>
            {% endif %}
            {% if req.approved != False %}
            <a class="btn btn-small" href="{{url('request_access_list')}}?deny_req={{req.id}}">{% trans %}Deny{% endtrans %}</a>
            {% endif %}
          </th>
        </tr>
      {% else %}
        <tr><td colspan="5">{% trans %}No requests{% endtrans %}</td></tr>
      {% endfor %}
      </tbody>
    </table>
  {% endfor %}

{% endblock %}
