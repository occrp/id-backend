{% macro render_table(objects, fields, request, model_name, no_entries="No entries found.", extra_class="", link_action="edit") %}
    {% if objects %}
        <table class="table table-striped table-bordered {{ extra_class }}">
            <thead>
                <tr>
                    {% for field in fields %}
                        <th>{{ objects[0].__class__[field]._verbose_name }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for obj in objects %}
                    <tr>
                        <td>
                            <a href="{{ uri_for('%s_%s' % (model_name, link_action), obj_id=obj.key.urlsafe()) }}">
                                {{ display_field(obj, fields[0]) }}
                            </a>
			</td>
		      {% for field in fields[1:] %}
                            <td>
                                {{ display_field(obj, field) }}
                            </td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="alert alert-block alert-warning">
            {{ no_entries }}
        </div>
    {% endif %}
{% endmacro %}

{% macro display_field(obj, field_name) %}
    {{ display_value(obj.get_display_value(field_name)) }}
{% endmacro %}

{% macro display_value(value) %}
    {%- set type = value.__class__.__name__ -%}
    {%- if False and type == 'date' or type =='datetime' -%}
        {{ display_datetime(value) }}
    {%- else -%}
        {{ value }}
    {%- endif %}
{% endmacro %}

{% macro display_datetime(value) %}
    {%- set type = value.__class__.__name__ -%}
    {%- if type == 'date' -%}
        <span class="date" data-date="{{ value.isoformat() }}" data-format="l"></span>
    {%- elif type == 'datetime' -%}
        <span class="datetime" data-datetime="{{ value.isoformat() }}" data-format="l LT"></span>
    {%- endif -%}
{% endmacro %}

{% macro help_box() %}
    <div class="alert alert-info">
        <div class="alert-icon"><i class="icon-question-sign"></i></div>
        <div class="alert-content">{{ caller() }}</div>
    </div>
{% endmacro %}

{% macro highlight(str, qry) -%}
    {{ str|replace(qry, "<span class='highlight'>%s</span>"|safe % qry) }}
{%- endmacro %}

{% macro request_detail(label, value) %}
    {% if value %}
        <div class="request-detail">
            <h5 class="yell soft">{{ label }}</h5>
            <p>{{ display_value(value) }}</p>
        </div>
    {% endif %}
{% endmacro %}

{% macro request_detail_multivalue(label, cols, value) %}
    {% if value %}
    <div class="request-detail">
    <h5 class="yell soft">{{ label }}</h5>
    <table class="table table-striped">
        <thead>
            <tr>
                {% for col in cols %}
                    <th>{{ col }}</th>
                {% endfor %}
            </tr>
        </thead>
    {%set rows = value.split('\n') %}
    {% for row in rows %}
        <tr>
            {% with %}
                {% set fields = row.split('\t') %}
                {% for i in range(0, cols|length) %}
                    <td>
                        {% if fields[i] is defined %}
                        {{ fields[i] }}
                        {% endif %}
                    </td>
                {% endfor %}
            {% endwith %}
        </tr>
    {% endfor %}
    </table>
    </div>
    {% endif %}
{% endmacro %}

{% macro list_files(instance) %}
    <table class="table table-bordered table-striped list-files"
           data-provide="list-files"
           data-folder-id="{{ instance.drive_folder_id }}">
        <thead>
            <tr>
                <th>{% trans %}File{% endtrans %}</th>
                <th style="width: 160px;">{% trans %}Created{% endtrans %}</th>
                <th style="width: 160px;">{% trans %}Last Modified{% endtrans %}</th>
                <th style="width: 160px;">{% trans %}Last Modified By{% endtrans %}</th>
                <th style="width: 55px;">{% trans %}Actions{% endtrans %}</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
{% endmacro %}

{% macro verbose_name(object, property_name) -%}
    {{ object.__class__[property_name]._verbose_name }}
{%- endmacro %}
